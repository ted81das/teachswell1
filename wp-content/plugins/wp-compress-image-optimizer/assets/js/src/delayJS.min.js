var preloadRunned=false;var windowWidth=window.innerWidth;var wpcEvents=["keydown","mousemove","touchmove","touchstart","touchend","wheel","visibilitychange","resize"];wpcEvents.forEach(function(eventName){if(jsDebug){console.log("Event registered: "+eventName)}window.addEventListener(eventName,function(){preloadTimeout(eventName)})});function preloadTimeout(event){if(jsDebug){console.log("Running Preload Timeout")}if(!preloadRunned){if(jsDebug){console.log("Event name in preload is ");console.log(event);console.log("Before width: "+windowWidth);console.log("After width: "+window.innerWidth)}if(event=="resize"){if(windowWidth===window.innerWidth){return false}}preloadRunned=true;setTimeout(function(){if(jsDebug){console.log("Inside Preload Timeout")}preload();removeEventListeners()},50)}}function removeEventListeners(){wpcEvents.forEach(function(eventName){window.removeEventListener(eventName,preloadTimeout)})}window.addEventListener("load",function(){var scrollTop=window.scrollY;if(scrollTop>60){preload()}});function preload(){var iframes=[].slice.call(document.querySelectorAll("iframe.wpc-iframe-delay"));var allScripts=[].slice.call(document.querySelectorAll('script[type="wpc-delay-script"]'));var styles=[].slice.call(document.querySelectorAll('[rel="wpc-stylesheet"]'));var mobileStyles=[].slice.call(document.querySelectorAll('[rel="wpc-mobile-stylesheet"]'));var wpScripts=[];var customPromiseFlag=[];if(jsDebug){console.log("Found scripts");console.log(allScripts)}for(var i=0;i<allScripts.length;i++){var script=allScripts[i];if(script.src&&script.src.includes("wp-includes")){wpScripts.push(script);allScripts.splice(i,1);i--}}if(jsDebug){console.log("Found WP scripts");console.log(wpScripts)}wpScripts.forEach(function(element,index){var newScript=document.createElement("script");newScript.setAttribute("src",element.getAttribute("src"));newScript.setAttribute("type","text/javascript");document.body.appendChild(newScript)});wpScripts=[];allScripts.forEach(function(element,index){var elementID=element.id;if(jsDebug){console.log(element)}if(!element.hasAttribute("src")&&!element.id.includes("-before")&&!element.id.includes("-after")&&!element.id.includes("-extra")){var newElement=document.createElement("script");newElement.textContent=element.textContent;newElement.setAttribute("type","text/javascript");newElement.async=false;document.body.appendChild(newElement)}else{var jsBefore=document.getElementById(elementID+"-before");var jsAfter=document.getElementById(elementID+"-after");var jsExtra=document.getElementById(elementID+"-extra");if(jsBefore!==null){var newElementBefore=document.createElement("script");newElementBefore.textContent=jsBefore.textContent;newElementBefore.setAttribute("type","text/javascript");newElementBefore.async=false;document.body.appendChild(newElementBefore)}if(jsAfter!==null){}if(jsExtra!==null){var newElementExtra=document.createElement("script");newElementExtra.textContent=jsExtra.textContent;newElementExtra.setAttribute("type","text/javascript");newElementExtra.async=false;document.body.appendChild(newElementExtra)}if(element!==null){var new_element=document.createElement("script");new_element.setAttribute("src",element.getAttribute("src"));new_element.setAttribute("type","text/javascript");new_element.async=false;new_element.onload=function(){if(jsAfter!==null){var new_elementAfter=document.createElement("script");new_elementAfter.textContent=jsAfter.textContent;new_elementAfter.setAttribute("type","text/javascript");document.body.appendChild(new_elementAfter);jsAfter.remove()}};document.body.appendChild(new_element)}if(element!==null){element.remove()}if(jsBefore!==null){jsBefore.remove()}if(jsExtra!==null){jsExtra.remove()}}});allScripts=[];styles.forEach(function(element,index){var promise=new Promise(function(resolve,reject){element.setAttribute("rel","stylesheet");element.setAttribute("type","text/css");element.addEventListener("load",function(){resolve()});element.addEventListener("error",function(){reject()})});customPromiseFlag.push(promise)});styles=[];iframes.forEach(function(element,index){var promise=new Promise(function(resolve,reject){var iframeUrl=element.getAttribute("data-src");element.setAttribute("src",iframeUrl);element.addEventListener("load",function(){resolve()});element.addEventListener("error",function(){reject()})});customPromiseFlag.push(promise)});iframes=[];mobileStyles.forEach(function(element,index){var promise=new Promise(function(resolve,reject){element.setAttribute("rel","stylesheet");element.setAttribute("type","text/css");element.addEventListener("load",function(){resolve()});element.addEventListener("error",function(){reject()})});customPromiseFlag.push(promise)});mobileStyles=[];Promise.all(customPromiseFlag).then(function(){var criticalCss=document.querySelector("#wpc-critical-css");if(criticalCss){criticalCss.remove()}}).catch(function(){styles.forEach(function(element,index){element.setAttribute("rel","stylesheet");element.setAttribute("type","text/css")})});wpcEvents.forEach(function(eventName){window.removeEventListener(eventName,preload)})}