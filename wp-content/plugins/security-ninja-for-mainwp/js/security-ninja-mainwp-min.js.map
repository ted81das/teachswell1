{"version":3,"sources":["security-ninja-mainwp.js"],"names":["jQuery","document","ready","update_visible_sites","each","thistestid","this","data","ajax","type","url","ajaxurl","action","_ajax_nonce","secninja_mainwp","nonce_secnin_getinfo","website","success","attr","removeClass","html","score","good","warning","bad","vulns","Object","keys","indexOf","secret_access","error","xhr","textStatus","_error","DataTable","on","console","log"],"mappings":"aACAA,OAAQC,UAAWC,OAAO,WAqDxB,SAASC,IAGPH,OAAO,iCAAiCI,MAAK,WAC3C,IAAIC,EAAaL,OAAOM,MAAMC,KAAK,WAGnCP,OAAOQ,KAAK,CACVC,KAAM,OACNC,IAAKC,QAELJ,KAAM,CACJK,OAAU,uBACVC,YAAeC,gBAAgBC,qBAC/BC,QAAWX,GAEbY,QAAS,SAAUV,GAEZA,EAAKA,MACRP,OAAO,kBAAoBK,EAAa,MAAMa,KAAK,cAAe,GAElElB,OAAQ,kBAAoBK,EAAa,eAAgBc,YAAY,aACrEnB,OAAQ,kBAAoBK,EAAa,oBAAqBe,KAAMb,EAAKA,KAAKc,OAC9ErB,OAAQ,kBAAoBK,EAAa,mBAAoBe,KAAM,oDAAoDb,EAAKA,KAAKe,KAAK,WACtItB,OAAQ,kBAAoBK,EAAa,sBAAuBe,KAAM,qDAAqDb,EAAKA,KAAKgB,QAAQ,WAC7IvB,OAAQ,kBAAoBK,EAAa,kBAAmBe,KAAM,kDAAkDb,EAAKA,KAAKiB,IAAI,WAG1G,OAApBjB,EAAKA,KAAKkB,MACZzB,OAAQ,kBAAoBK,EAAa,oBAAqBe,KAAMb,EAAKA,KAAKkB,OAG9EzB,OAAQ,kBAAoBK,EAAa,oBAAqBe,KAAM,KAIZ,IAArDM,OAAOC,KAAKpB,EAAKA,MAAMqB,QAAQ,kBAClC5B,OAAQ,kBAAoBK,EAAa,4BAA6Be,KAAM,YAAcb,EAAKA,KAAKsB,cAAgB,2EAMtH7B,OAAQ,kBAAoBK,EAAa,eAAgBc,YAAY,aACrEnB,OAAQ,kBAAoBK,EAAa,oBAAqBe,KAAM,SAGxEU,MAAO,SAAUC,EAAKC,EAAYC,UAlGxCjC,OAAO,mBAAmBkC,YAC1B/B,IAOAH,OAAQ,wCAAyCmC,GAAI,UAAU,WAE7D,OADAhC,KACO,KAMTH,OAAQ,8BAA+BmC,GAAI,SAAS,WAElD,OADAhC,KACO,KAMTH,OAAO,cAAcmC,GAAG,SAAS,WAE/B,OADAhC,KACO,KAMTH,OAAQ,iCAAkCmC,GAAI,SAAS,WAGrD,OAFAC,QAAQC,IAAI,oBACZlC,KACO","sourcesContent":["/* globals jQuery:true, ajaxurl:true, secninja_mainwp:true */\njQuery( document ).ready( function() {\n  \n  jQuery(\"#security-ninja\").DataTable();\n  update_visible_sites();\n  \n\n  \n  /**\n  * Site events switch handler.\n  */\n  jQuery( 'select[name=\"security-ninja_length\"]' ).on( 'change', function() {\n    update_visible_sites();\n    return false;\n  });\n  \n  /**\n  * Pagination button clicks. \n  */\n  jQuery( '#security-ninja_paginate a' ).on( 'click', function() {\n    update_visible_sites();\n    return false;\n  });\n  \n  /*\n  * Hack - clicking any sort table header\n  */\n  jQuery('th.sorting').on('click', function () {\n    update_visible_sites();\n    return false;\n   });\n\n  /*\n  * Hack - clicking pagination button\n  */\n  jQuery( '.pagination a.paginate_button' ).on( 'click', function () {\n    console.log('clicked paginate');\n    update_visible_sites();\n    return false;\n   });\n   \n\n\n\n  /**\n  * update_visible_sites.\n  *\n  * @author\tLars Koudal\n  * @since\tv0.0.1\n  * @version\tv1.0.0\tThursday, May 5th, 2022.\t\n  * @version\tv1.0.1\tWednesday, May 25th, 2022.\n  * @global\n  * @return\tvoid\n  */\n  function update_visible_sites() {\n    \n    // Start main processing\n    jQuery('tr.secninrow[data-snload=\"0\"]').each(function () {\n      var thistestid = jQuery(this).data('website');\n\n\n      jQuery.ajax({\n        type: 'POST',\n        url: ajaxurl,\n        //async: true,\n        data: {\n          'action': 'secnin_get_test_info',\n          '_ajax_nonce': secninja_mainwp.nonce_secnin_getinfo,\n          'website': thistestid\n        },\n        success: function (data) {\n          \n          if ( data.data ) {\n            jQuery('[data-website=\"' + thistestid + '\"]').attr('data-snload', 1);\n\n            jQuery( '[data-website=\"' + thistestid + '\"] .spinner' ).removeClass('is-active');\n            jQuery( '[data-website=\"' + thistestid + '\"] .secnin-score' ).html( data.data.score );\n            jQuery( '[data-website=\"' + thistestid + '\"] .secnin-good' ).html( '<span class=\"ui basic mini compact button green\">'+data.data.good+'</span>' );\n            jQuery( '[data-website=\"' + thistestid + '\"] .secnin-warning' ).html( '<span class=\"ui basic mini compact button yellow\">'+data.data.warning+'</span>' );   \n            jQuery( '[data-website=\"' + thistestid + '\"] .secnin-bad' ).html( '<span class=\"ui basic mini compact button red\">'+data.data.bad+'</span>' );\n\n            // If there are vulns\n            if (data.data.vulns !== null) {\n              jQuery( '[data-website=\"' + thistestid + '\"] .secnin-vulns' ).html( data.data.vulns ); \n            }\n            else {\n              jQuery( '[data-website=\"' + thistestid + '\"] .secnin-vulns' ).html( '' ); \n            }\n            \n            // If there is a secret access URL\n            if ( Object.keys(data.data).indexOf('secret_access') !== -1 ) {\n              jQuery( '[data-website=\"' + thistestid + '\"] .secnin-secret-access' ).html( '<a href=\"' + data.data.secret_access + '\" target=\"_blank\" rel=\"noopener\"><i class=\"user secret icon\"></i></a>' ); \n            }\n            \n          }\n          else {\n            // No results from the website - \n            jQuery( \"[data-website='\" + thistestid + \"'] .spinner\" ).removeClass('is-active');\n            jQuery( '[data-website=\"' + thistestid + '\"] .secnin-score' ).html( 'N/A' );\n          }\n        },\n        error: function (xhr, textStatus, error) {\n          //console.log( 'Website ' + thistestid + ' failed' ); // @debug\n        }\n      });\n    });\n    \n    \n  }\n  \n  \n  \n  \n  /* Run tests on site */\n  /*\n  jQuery(document).on('click', '.secnin-action .button.reruntests', function (e) {\n    \n    jQuery(this).attr('disabled',true);\n    \n    e.preventDefault();\n    var website = jQuery(e).data('website');\n    \n    jQuery(e).attr('disabled', true);\n    jQuery(this).parent('.secnin-action').append('DAVS');\n    \n    console.log('.reruntests ',secninja_mainwp);\n    \n    jQuery('.wrap').prepend('<div class=\"secning-loading-popup\"><p>Please wait<span class=\"spinner is-active\"></span></p></div>');\n    \n    jQuery.ajax({\n      url: ajaxurl,\n      type: 'POST',\n      async: true,\n      data: {\n        'action' :'secnin_update_site_info',\n        '_ajax_nonce': secninja_mainwp.nonce_secnin_getinfo,\n        'website': website,\n      },\n      success: function( response ) {\n        console.log( response );\n        //window.location.reload();\n      },\n      error: function( response ) {\n        window.location.reload();\n      }\n    });\n    \n  });\n  */\n  \n  \n  \n  \n  \n  \n});"]}